/**
 *
 * Inline Style
 *
 * @author Takuto Yanagida @ Space-Time Inc.
 * @version 2018-11-12
 *
 */


@import '../basic/base';
@import '../basic/font';
@import '../basic/layout';


$stile-inline-color-strong       : rgba(#000, 0.95) !default;
$stile-inline-color-underline    : rgba(#fd0, 0.90) !default;
$stile-inline-color-mark         : rgba(#fe0, 0.90) !default;
$stile-inline-color-del          : rgba(#f40, 0.90) !default;
$stile-inline-color-abbr         : rgba(#12f, 0.90) !default;
$stile-inline-color-broken-image : $stile-inline-color-del !default;
$stile-inline-width-underline    : 0.4em !default;
$stile-inline-width-mark         : 1.0em !default;
$stile-inline-width-del          : 0.15em !default;
$stile-inline-size-font-small    : 0.85em !default;
$stile-inline-size-font-subscript: 0.75em !default;
$stile-inline-size-font-monospace: 0.95em !default;


@mixin stile-inline {
	img {
		max-width: 100%;
		height: auto;

		// for broken images (does not work on IE11 and Edge)
		&[alt]::after {
			content: attr(src);
			@include layout-centering(true);

			padding: base-vr(0.5) base-vr(1);
			border: 1px dashed $stile-inline-color-broken-image;
			min-height: base-vr(2);

			color: $stile-inline-color-broken-image;
			font-size: 0.85em;
			line-height: 1.35em;
			word-break: break-all;
			text-decoration: line-through;

			vertical-align: text-bottom;
		}
		transition: opacity 0.2s;  // for lazy loading
	}
	strong, b {
		@include font-bold;
	}
	em, cite {
		font-style: italic;
	}
	p, li, dd, td, th, del, code, span:not([class]) {
		> {
			strong, b, em, mark { color: $stile-inline-color-strong; }
		}
	}
	u, span[data-stile ~= 'inline-underline'] {
		text-decoration: none;
		background-image: linear-gradient(to right, $stile-inline-color-underline 0%, transparentize($stile-inline-color-underline, 0.25) 100%);
		background-size: 100% $stile-inline-width-underline;
		background-repeat: no-repeat;
		background-position: left bottom;
	}
	span:not([data-stile]) {  // Before the script loaded
		&[style = 'text-decoration:underline;'],
		&[style = 'text-decoration: underline;'] {
			text-decoration: underline darken($stile-inline-color-underline, 10%) !important;
		}
	}
	mark {
		text-decoration: none;
		background-image: linear-gradient(to right, $stile-inline-color-mark 0%, transparentize($stile-inline-color-mark, 0.45) 100%);
		background-size: 100% $stile-inline-width-mark;
		background-repeat: no-repeat;
		background-position: left center;
	}
	del {
		text-decoration: none;
		background-image: linear-gradient(to right, $stile-inline-color-del 0%, transparentize($stile-inline-color-del, 0.25) 100%);
		background-size: 100% $stile-inline-width-del;
		background-repeat: no-repeat;
		background-position: left 55%;
	}
	small {
		font-size: $stile-inline-size-font-small;
	}
	sub, sup {
		position: relative;
		display: inline-block;  // for neat line height
		vertical-align: inherit;
		line-height: 1;
		margin-right: 0.1em;
		font-size: $stile-inline-size-font-subscript;
	}
	sub {
		bottom: -0.25em;
		margin-bottom: -0.25em;
	}
	sup {
		top: -0.75em;
		margin-top: -0.75em;
	}
	abbr[title] {
		text-decoration: none;
		border-bottom: 2px dotted $stile-inline-color-abbr;
	}
	code, var, samp, kbd {
		@include font-family-monospace;
		margin-left: 0.075rem;
		margin-right: 0.075rem;
		white-space: pre-wrap;
		font-size: $stile-inline-size-font-monospace;
	}
	*[data-stile ~= 'iframe-wrapper'] {
		display: inline-block;
		width: 100%;
		position: relative;
		> iframe {
			@include layout-fill-self;
			height: 100%;
		}
	}
}
